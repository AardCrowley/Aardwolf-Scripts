<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Monday, March 06, 2023, 3:41 PM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "HyperlinkNote" generated by Plugin Wizard -->

<muclient>
<plugin
   name="HyperlinkNote"
   author="Crowley"
   id="86036453314d70616b0239e1"
   language="Lua"
   purpose="Creates hyperlinks of notes to click and read."
   save_state="y"
   date_written="2023-03-06 15:39:30"
   requires="4.99"
   version="1.0"
   >

</plugin>


<!--  Aliases  -->

<aliases>
  <alias
   match="^(note (list(?: \d+)?|unread))$"
   enabled="y"
   group="zzzzNote"
   regexp="y"
   send_to="12"
   sequence="50"
  >
  <send>
   StopEvaluatingTriggers(true)
   Capture.untagged_output("%1", true, true, true, hyperlinknotes, false)
   </send>
  </alias>
</aliases>

<!--  Script  -->


<script>
<![CDATA[

local f = io.open(GetInfo(66) .. "/lua/wrapped_captures.lua")

if f == nil then
   ColourNote("white", "blue", "Sorry, you do not have 'wrapped_captures.lua' and will not be able to use this script. Please update your snapshot of the AardMUSH package to use this plugin. Unloading plugin to prevent issues.")
   Execute(GetAlphaOption("script_prefix") .. 'DoAfterSpecial(1, "UnloadPlugin(\'' .. GetPluginID() .. '\')", sendto.script)')
else
   require "wrapped_captures"
   f:close()
end

function hyperlinknotes(lines)
   for i,v in ipairs(lines) do
      if i < 5 or i == #lines then
         Simulate(stylesToANSI(v) .. "\n")
      else
         for j,k in ipairs(v) do
            if j == 2 then
               Hyperlink("note read " .. k.text, k.text, "", RGBColourToName(k.textcolour), RGBColourToName(k.backcolour))
            else
               ColourTell(RGBColourToName(k.textcolour), RGBColourToName(k.backcolour), k.text)
            end
         end
         Note("")
      end
   end
end

]]>
</script>


</muclient>
